
<div class="animate-fade-in">
  <!-- Page Header -->
  <div class="content-header">
    <div class="breadcrumb">
      <span>Master</span>
      <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
      <span class="breadcrumb-active">Member Details</span>
    </div>
    <h1 class="text-page-title">Member Management</h1>
    <p class="text-body text-gray-600 dark:text-gray-400">Manage member information, accounts, and details</p>
  </div>

  <!-- Statistics Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="card hover:shadow-lg transition-all duration-200">
      <div class="card-content">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-caption text-gray-500 mb-1">Total Members</p>
            <p class="text-2xl font-bold text-blue-600">{{ getTotalMembers() }}</p>
          </div>
          <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center">
            <mat-icon class="text-blue-600 text-2xl">people</mat-icon>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card hover:shadow-lg transition-all duration-200">
      <div class="card-content">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-caption text-gray-500 mb-1">Active Members</p>
            <p class="text-2xl font-bold text-green-600">{{ getActiveMembers() }}</p>
          </div>
          <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center">
            <mat-icon class="text-green-600 text-2xl">person_check</mat-icon>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card hover:shadow-lg transition-all duration-200">
      <div class="card-content">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-caption text-gray-500 mb-1">Inactive Members</p>
            <p class="text-2xl font-bold text-red-600">{{ getInactiveMembers() }}</p>
          </div>
          <div class="w-12 h-12 bg-red-100 dark:bg-red-900 rounded-xl flex items-center justify-center">
            <mat-icon class="text-red-600 text-2xl">person_off</mat-icon>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card hover:shadow-lg transition-all duration-200">
      <div class="card-content">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-caption text-gray-500 mb-1">This Month</p>
            <p class="text-2xl font-bold text-purple-600">{{ getThisMonthMembers() }}</p>
          </div>
          <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center">
            <mat-icon class="text-purple-600 text-2xl">person_add</mat-icon>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Card -->
  <div class="card">
    <div class="card-header">
      <div class="card-title">
        <mat-icon>people</mat-icon>
        <span>All Members</span>
      </div>
      <div class="flex items-center gap-3">
        <button class="btn btn-outline btn-sm">
          <mat-icon class="text-sm">download</mat-icon>
          Export
        </button>
        <button class="btn btn-primary btn-sm" (click)="openAddMemberDialog()">
          <mat-icon class="text-sm">person_add</mat-icon>
          Add Member
        </button>
      </div>
    </div>

    <!-- Filters Section -->
    <div class="table-filters">
      <div class="flex flex-wrap items-center gap-4 w-full">
        <!-- Search Input -->
        <div class="flex-1 min-w-64">
          <div class="form-field">
            <input 
              type="text" 
              class="form-input"
              placeholder="Search by name, ID, phone, or email..."
              [(ngModel)]="searchTerm"
              (input)="filterMembers()">
          </div>
        </div>

        <!-- Status Filter -->
        <div class="min-w-40">
          <div class="form-field">
            <select 
              class="form-select"
              [(ngModel)]="selectedStatus"
              (change)="filterMembers()">
              <option value="">All Status</option>
              <option value="active">Active</option>
              <option value="inactive">Inactive</option>
              <option value="pending">Pending</option>
            </select>
          </div>
        </div>

        <!-- Category Filter -->
        <div class="min-w-40">
          <div class="form-field">
            <select 
              class="form-select"
              [(ngModel)]="selectedCategory"
              (change)="filterMembers()">
              <option value="">All Categories</option>
              <option value="regular">Regular</option>
              <option value="associate">Associate</option>
              <option value="life">Life</option>
            </select>
          </div>
        </div>

        <!-- Clear Filters -->
        <button 
          class="btn btn-secondary btn-sm"
          (click)="clearFilters()">
          <mat-icon class="text-sm">clear</mat-icon>
          Clear
        </button>
      </div>
    </div>

    <!-- Members Table -->
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="dataSource" class="w-full">
        
        <!-- Member ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Member ID</th>
          <td mat-cell *matCellDef="let member" class="font-medium text-blue-600">
            #{{ member.id }}
          </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Name</th>
          <td mat-cell *matCellDef="let member">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm">
                {{ getInitials(member.name) }}
              </div>
              <div>
                <p class="font-medium">{{ member.name }}</p>
                <p class="text-caption text-gray-500">{{ member.fatherName }}</p>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Contact Column -->
        <ng-container matColumnDef="contact">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Contact</th>
          <td mat-cell *matCellDef="let member">
            <div>
              <p class="font-medium">{{ member.phone }}</p>
              <p class="text-caption text-gray-500">{{ member.email }}</p>
            </div>
          </td>
        </ng-container>

        <!-- Address Column -->
        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Address</th>
          <td mat-cell *matCellDef="let member">
            <div class="max-w-48">
              <p class="text-sm line-clamp-2">{{ member.address }}</p>
            </div>
          </td>
        </ng-container>

        <!-- Category Column -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Category</th>
          <td mat-cell *matCellDef="let member">
            <span [class]="getCategoryBadgeClass(member.category)">
              {{ member.category | titlecase }}
            </span>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Status</th>
          <td mat-cell *matCellDef="let member">
            <span [class]="getStatusBadgeClass(member.status)">
              <mat-icon class="text-xs mr-1">{{ getStatusIcon(member.status) }}</mat-icon>
              {{ member.status | titlecase }}
            </span>
          </td>
        </ng-container>

        <!-- Join Date Column -->
        <ng-container matColumnDef="joinDate">
          <th mat-header-cell *matHeaderCellDef class="font-semibold">Join Date</th>
          <td mat-cell *matCellDef="let member">
            <div>
              <p class="font-medium">{{ member.joinDate | date:'mediumDate' }}</p>
              <p class="text-caption text-gray-500">{{ getDateFromNow(member.joinDate) }}</p>
            </div>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-center">Actions</th>
          <td mat-cell *matCellDef="let member">
            <div class="flex items-center justify-center gap-1">
              <button 
                class="btn btn-secondary btn-sm btn-icon"
                matTooltip="View Details"
                (click)="viewMember(member)">
                <mat-icon class="text-sm">visibility</mat-icon>
              </button>
              <button 
                class="btn btn-outline btn-sm btn-icon"
                matTooltip="Edit Member"
                (click)="editMember(member)">
                <mat-icon class="text-sm">edit</mat-icon>
              </button>
              <button 
                class="btn btn-danger btn-sm btn-icon"
                matTooltip="Delete Member"
                (click)="deleteMember(member)">
                <mat-icon class="text-sm">delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200"></tr>
      </table>
    </div>

    <!-- No Data Message -->
    <div *ngIf="dataSource.data.length === 0" class="text-center py-12">
      <mat-icon class="text-gray-400 text-6xl mb-4">people_outline</mat-icon>
      <h3 class="text-section-header text-gray-500 mb-2">No Members Found</h3>
      <p class="text-body text-gray-400 mb-4">
        {{ searchTerm || selectedStatus || selectedCategory ? 'No members match your current filters.' : 'Start by adding your first member.' }}
      </p>
      <button class="btn btn-primary" (click)="openAddMemberDialog()">
        <mat-icon>person_add</mat-icon>
        Add First Member
      </button>
    </div>

    <!-- Pagination -->
    <div *ngIf="dataSource.data.length > 0" class="border-t border-gray-200 dark:border-gray-700">
      <mat-paginator
        [pageSizeOptions]="[10, 25, 50, 100]"
        [pageSize]="10"
        showFirstLastButtons
        aria-label="Select page of members">
      </mat-paginator>
    </div>
  </div>
</div>
