<div class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
  <!-- Mobile menu button -->
  <div *ngIf="!isLoginPage()" class="lg:hidden fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 shadow-md">
    <div class="flex items-center justify-between p-4">
      <button
        (click)="toggleMobileSidebar()"
        class="p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
      >
        <mat-icon>menu</mat-icon>
      </button>
      <h1 class="text-lg font-semibold text-gray-900 dark:text-white">FMS</h1>
      <button
        mat-icon-button
        [matMenuTriggerFor]="userMenu"
        *ngIf="isLoggedIn()"
        class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
      >
        <mat-icon class="text-gray-600 dark:text-gray-300">account_circle</mat-icon>
      </button>
    </div>
  </div>

  <!-- Sidebar -->
  <aside
    *ngIf="!isLoginPage()"
    class="fixed inset-y-0 left-0 z-40 w-72 bg-white dark:bg-gray-800 shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0"
    [class.translate-x-0]="isMobileSidebarOpen"
    [class.-translate-x-full]="!isMobileSidebarOpen"
  >
    <!-- Sidebar header -->
    <div class="flex items-center justify-center h-20 px-6 bg-gradient-to-br from-primary-500 to-primary-700 dark:from-primary-600 dark:to-primary-800">
      <div class="text-center">
        <mat-icon class="text-4xl text-white mb-2">account_balance</mat-icon>
        <h2 class="text-lg font-bold text-white leading-tight">Financial Management</h2>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto h-[calc(100vh-5rem)]">
      <!-- User Management - Only for Super Admin -->
      <div *ngIf="currentUser?.role === 'super_admin'" class="space-y-1">
        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
          User Management
        </div>
        <a
          routerLink="/user-management"
          routerLinkActive="bg-blue-50 dark:bg-blue-900 border-r-4 border-blue-600 text-blue-600 dark:text-blue-400"
          class="group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          <mat-icon class="text-gray-400 group-hover:text-gray-500 dark:text-gray-400 dark:group-hover:text-gray-300 flex-shrink-0 -ml-1 mr-3 h-6 w-6">manage_accounts</mat-icon>
          <span class="truncate">All Users</span>
        </a>
      </div>

      <!-- Member Management - For Super Admin and Society Admin -->
      <div *ngIf="currentUser?.role === 'super_admin' || currentUser?.role === 'society_admin'" class="space-y-1">
        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
          Member Management
        </div>
        <a
          routerLink="/master/member-details"
          routerLinkActive="bg-blue-50 dark:bg-blue-900 border-r-4 border-blue-600 text-blue-600 dark:text-blue-400"
          class="group flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          <mat-icon class="text-gray-400 group-hover:text-gray-500 dark:text-gray-400 dark:group-hover:text-gray-300 flex-shrink-0 -ml-1 mr-3 h-6 w-6">people</mat-icon>
          <span class="truncate">Member Details</span>
        </a>
      </div>


      <!-- File Menu -->
      <div class="space-y-1">
        <button
          (click)="toggleFileMenu()"
          class="flex items-center justify-between w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200"
        >
          <div class="flex items-center">
            <mat-icon class="mr-3 text-gray-500 dark:text-gray-400">folder</mat-icon>
            File
          </div>
          <mat-icon [class.rotate-180]="isFileMenuOpen" class="transform transition-transform duration-200">expand_more</mat-icon>
        </button>

        <div *ngIf="isFileMenuOpen" class="ml-6 space-y-1 border-l-2 border-gray-200 dark:border-gray-600 pl-4">
          <!-- Security Submenu -->
          <div class="space-y-1">
            <button
              (click)="toggleSecurityMenu()"
              class="flex items-center justify-between w-full px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
            >
              <div class="flex items-center">
                <mat-icon class="mr-2 text-xs">security</mat-icon>
                Security
              </div>
              <mat-icon [class.rotate-180]="isSecurityMenuOpen" class="transform transition-transform duration-200 text-xs">expand_more</mat-icon>
            </button>

            <div *ngIf="isSecurityMenuOpen" class="ml-4 space-y-1">
              <a *ngIf="isSuperAdmin()" routerLink="/file/security/authority" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Authority</a>
              <a routerLink="/file/security/my-rights" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">My Rights</a>
              <a *ngIf="canCreateUsers()" routerLink="/file/security/new-user" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">New User</a>
              <a routerLink="/file/security/retrieve-password" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Retrieve Password</a>
              <a routerLink="/file/security/change-password" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Change Password</a>
              <a *ngIf="isSuperAdmin()" routerLink="/file/security/admin-handover" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-xs text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Admin Handover</a>
            </div>
          </div>

          <a routerLink="/file/society" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Society</a>
          <a *ngIf="canManageFinancialYear()" routerLink="/file/create-new-year" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Create New Year</a>
          <a *ngIf="canEditOpeningBalance()" routerLink="/file/edit-opening-balance" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Edit Opening Balance</a>
        </div>
      </div>

      <!-- Master Menu -->
      <div *ngIf="canAccessMaster()" class="space-y-1">
        <button
          (click)="toggleMasterMenu()"
          class="flex items-center justify-between w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200"
        >
          <div class="flex items-center">
            <mat-icon class="mr-3 text-gray-500 dark:text-gray-400">storage</mat-icon>
            Master
          </div>
          <mat-icon [class.rotate-180]="isMasterMenuOpen" class="transform transition-transform duration-200">expand_more</mat-icon>
        </button>

        <div *ngIf="isMasterMenuOpen" class="ml-6 space-y-1 border-l-2 border-gray-200 dark:border-gray-600 pl-4">
          <a routerLink="/master/member-details" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Member Details</a>
          <a routerLink="/master/table" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Table</a>
          <a *ngIf="isSuperAdmin() || isSocietyAdmin()" routerLink="/master/deposit-scheme" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Deposit Scheme</a>
          <a *ngIf="isSuperAdmin() || isSocietyAdmin()" routerLink="/master/interest-master" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Interest Master</a>
        </div>
      </div>

      <!-- Transaction Menu -->
      <div *ngIf="canAccessTransactions()" class="space-y-1">
        <button
          (click)="toggleTransactionMenu()"
          class="flex items-center justify-between w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200"
        >
          <div class="flex items-center">
            <mat-icon class="mr-3 text-gray-500 dark:text-gray-400">receipt</mat-icon>
            Transaction
          </div>
          <mat-icon [class.rotate-180]="isTransactionMenuOpen" class="transform transition-transform duration-200">expand_more</mat-icon>
        </button>

        <div *ngIf="isTransactionMenuOpen" class="ml-6 space-y-1 border-l-2 border-gray-200 dark:border-gray-600 pl-4">
          <a routerLink="/transaction/loan-taken" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Loan Taken</a>
          <a routerLink="/transaction/demand-process" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Demand Process</a>
          <a *ngIf="isSuperAdmin() || isSocietyAdmin()" routerLink="/transaction/account-closure" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Account Closure</a>
          <a routerLink="/transaction/deposit-receipt" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Deposit Receipt</a>
          <a routerLink="/transaction/deposit-renew" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Deposit Renew</a>
          <a routerLink="/transaction/deposit-slip" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Deposit Slip</a>
          <a routerLink="/transaction/deposit-payment" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Deposit Payment</a>
        </div>
      </div>

      <!-- Accounts Menu -->
      <div *ngIf="canAccessAccounts()" class="space-y-1">
        <button
          (click)="toggleAccountsMenu()"
          class="flex items-center justify-between w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200"
        >
          <div class="flex items-center">
            <mat-icon class="mr-3 text-gray-500 dark:text-gray-400">account_balance</mat-icon>
            Accounts
          </div>
          <mat-icon [class.rotate-180]="isAccountsMenuOpen" class="transform transition-transform duration-200">expand_more</mat-icon>
        </button>

        <div *ngIf="isAccountsMenuOpen" class="ml-6 space-y-1 border-l-2 border-gray-200 dark:border-gray-600 pl-4">
          <a routerLink="/accounts/group" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Group</a>
          <a routerLink="/accounts/ledger" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Ledger</a>
          <a routerLink="/accounts/cash-book" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Cash Book</a>
          <a routerLink="/accounts/day-book" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-gray-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Day Book</a>
          <a routerLink="/accounts/voucher" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Voucher</a>
          <a routerLink="/accounts/loan-receipt" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Loan Receipt</a>
          <a routerLink="/accounts/trial-balance" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Trial Balance</a>
          <a routerLink="/accounts/balance-sheet" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Balance Sheet</a>
          <a routerLink="/accounts/profit-loss" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Profit & Loss</a>
          <a routerLink="/accounts/receipt-payment" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Receipt & Payment</a>
        </div>
      </div>

      <!-- Reports Menu -->
      <div *ngIf="canAccessReports()" class="space-y-1">
        <button
          (click)="toggleReportsMenu()"
          class="flex items-center justify-between w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200"
        >
          <div class="flex items-center">
            <mat-icon class="mr-3 text-gray-500 dark:text-gray-400">assessment</mat-icon>
            Reports
          </div>
          <mat-icon [class.rotate-180]="isReportsMenuOpen" class="transform transition-transform duration-200">expand_more</mat-icon>
        </button>

        <div *ngIf="isReportsMenuOpen" class="ml-6 space-y-1 border-l-2 border-gray-200 dark:border-gray-600 pl-4">
          <a routerLink="/reports/employees" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Employees</a>
          <a routerLink="/reports/voucher" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Voucher</a>
          <a routerLink="/reports/opening-balance" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Opening Balance</a>
          <a routerLink="/reports/closing-balance" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Closing Balance</a>
          <a routerLink="/reports/loan" routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-600 dark:text-primary-400" class="block px-3 py-2 text-sm text-gray-600 dark:text-gray-400 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">Loan</a>
        </div>
      </div>

      <!-- Other Menu Items -->
      <a
        routerLink="/statement"
        routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300 border-r-3 border-primary-500"
        class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 group"
      >
        <mat-icon class="mr-3 text-gray-500 dark:text-gray-400 group-hover:text-primary-500">description</mat-icon>
        Statement
      </a>

      <a
        *ngIf="canAccessBackup()"
        routerLink="/backup"
        routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300 border-r-3 border-primary-500"
        class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 group"
      >
        <mat-icon class="mr-3 text-gray-500 dark:text-gray-400 group-hover:text-primary-500">backup</mat-icon>
        Backup
      </a>

      <a
        *ngIf="canAccessAdmin()"
        routerLink="/admin"
        routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300 border-r-3 border-primary-500"
        class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 group"
      >
        <mat-icon class="mr-3 text-gray-500 dark:text-gray-400 group-hover:text-primary-500">admin_panel_settings</mat-icon>
        Admin
      </a>

      <a
        *ngIf="canManageFinancialYear()"
        routerLink="/new-year"
        routerLinkActive="bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300 border-r-3 border-primary-500"
        class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 group"
      >
        <mat-icon class="mr-3 text-gray-500 dark:text-gray-400 group-hover:text-primary-500">calendar_today</mat-icon>
        New Year
      </a>

      <!-- Logout -->
      <div class="pt-4 border-t border-gray-200 dark:border-gray-600">
        <a
          routerLink="/login"
          class="flex items-center px-4 py-3 text-sm font-medium text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-200 group"
        >
          <mat-icon class="mr-3 group-hover:text-red-500">exit_to_app</mat-icon>
          Exit
        </a>
      </div>
    </nav>
  </aside>

  <!-- Mobile sidebar overlay -->
  <div
    *ngIf="isMobileSidebarOpen && !isLoginPage()"
    class="fixed inset-0 z-30 bg-black bg-opacity-50 lg:hidden"
    (click)="closeMobileSidebar()"
  ></div>

  <!-- Main content -->
  <div [class.lg:ml-72]="!isLoginPage()">
    <!-- Top navigation bar -->
    <header *ngIf="!isLoginPage()" class="hidden lg:block bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
      <div class="px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Financial Management System</h1>
          </div>

          <div class="flex items-center space-x-4">
            <!-- Theme toggle -->
            <button
              (click)="toggleTheme()"
              class="p-2 rounded-lg text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
            >
              <mat-icon>{{ isDarkMode ? 'light_mode' : 'dark_mode' }}</mat-icon>
            </button>

            <!-- User info -->
            <div *ngIf="isLoggedIn()" class="text-sm text-gray-600 dark:text-gray-300">
              {{ currentUser?.societyName ? currentUser?.societyName + ' - ' : '' }}{{ getUserRoleDisplayName() }}
            </div>

            <!-- User menu -->
            <button
              *ngIf="isLoggedIn()"
              mat-icon-button
              [matMenuTriggerFor]="userMenu"
              class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
            >
              <mat-icon class="text-gray-600 dark:text-gray-300">account_circle</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Page content -->
    <main [class]="isLoginPage() ? 'min-h-screen bg-gray-50 dark:bg-gray-900' : 'min-h-screen pt-16 lg:pt-0 p-6 bg-gray-50 dark:bg-gray-900'">
      <div [class]="isLoginPage() ? '' : 'max-w-7xl mx-auto'">
        <router-outlet></router-outlet>
      </div>
    </main>
  </div>

  <!-- User menu -->
  <mat-menu #userMenu="matMenu" class="mt-2">
    <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-600">
      <p class="text-sm font-medium text-gray-900 dark:text-white">{{currentUserName}}</p>
      <p class="text-xs text-gray-500 dark:text-gray-400">{{ getUserRoleDisplayName() }}</p>
    </div>
    <button mat-menu-item class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
      <mat-icon class="mr-3">person</mat-icon>
      Profile
    </button>
    <button mat-menu-item class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
      <mat-icon class="mr-3">settings</mat-icon>
      Settings
    </button>
    <button mat-menu-item (click)="logout()" class="flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20">
      <mat-icon class="mr-3">logout</mat-icon>
      Logout
    </button>
  </mat-menu>
</div>